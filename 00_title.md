<!-- markdownlint-disable MD012 MD014 -->

# Introduction to Vulnerability Scanning



## What is CVE

* CVE = Common Vulnerabilities and Exposures

> Unique, common identifiers for publicly known information-security vulnerabilities in publicly released software packages
([Wikipedia](https://en.wikipedia.org/wiki/Common_Vulnerabilities_and_Exposures))

* https://cve.mitre.org/
* https://nvd.nist.gov/vuln/full-listing


## Example

* https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-11693
> An issue was discovered in LibSass through 3.5.4. An out-of-bounds read of a memory region was found in the function Sass::Prelexer::skip_over_scopes which could be leveraged by an attacker to disclose information or manipulated to read from unmapped memory causing a denial of service.


## Scanning for vulnerabilties

* Operating system
  * Installed software packages
* Docker container images
* Application
  * Used libraries and frameworks

* Left-shift security
  * Integration into CI/ CD



### [GitHub](https://github.com/stefanfreitag/introToAwsMsk/issues/18)

* Scanning via integrations with GitHub apps, e.g. Whitesource Bolt
* Scan is executed on every commit

<img src="images/whitesource_bolt_found_vulnerabilities.png" alt="" height="300px"/>


Findings

<img src="images/whitesource_bolt_overview.png" alt="" height="600px"/>

CVSS = Commomn Vulnerability Scoring System


[Details](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-9251)

<img src="images/whitesource_bolt_example.png" alt="" height="600px"/>



### Container image scanning

* Various Docker image registries exist
  * [DockerHub](https://hub.docker.com/)
  * [AWS Elastic Container Registry](https://aws.amazon.com/de/ecr/)
  * [Google Container Registry](https://cloud.google.com/container-registry/?hl=de)
  * Self-hosted


#### AWS ECR

_Scan on Push_ feature

<img src="images/aws_ecr_repositories.png" alt="" height="450px"/>


Scanned images with high level information

<img src="images/aws_ecr_repositories_coretto_8.png" alt="" height="550px"/>


Detailed information of a scan

<img src="images/aws_ecr_repositories_coretto_8_scan_result.png" alt="" height="600px"/>


Retrieval via CLI

~~~bash
$ aws ecr describe-image-scan-findings
    --repository-name=coretto-8
    --image-id imageTag=latest | jq
        -r '.imageScanFindings.findingSeverityCounts'

{
  "LOW": 1,
  "MEDIUM": 2
}
~~~



## Scanning for Java based projects



## Scanning for Angular based projects




## Further information

* [AquaSec trivy](https://github.com/aquasecurity/trivy)
* [Clair](https://coreos.com/clair/docs/latest/)
* [Dependency-Check](https://jeremylong.github.io/DependencyCheck/dependency-check-gradle/index.html)
* [Whitesource Bolt](https://bolt.whitesourcesoftware.com/)
* [Wikipedia on CVE](https://en.wikipedia.org/wiki/Common_Vulnerabilities_and_Exposures)
* [Wikipedia on CVE Scoring System](https://en.wikipedia.org/wiki/Common_Vulnerability_Scoring_System)
